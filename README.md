# Plant Seedlings Classification

## Цель проекта
Разработка и развертывание модели глубокого обучения для многоклассовой классификации ростков растений с целью автоматического распознавания сорняков. Это позволит создать основу для систем точечной обработки полей. Что приведет:
*   Повышение урожайности: сорняки конкурируют с культурными растениями за воду, свет и питательные вещества. Их своевременное удаление напрямую увеличивает урожайность культурных растений.
*   Снижение затрат на гербициды: вместо обработки всего поля, автономные системы (роботы, дроны) с использованием нашей модели смогут точечно наносить гербициды только на сорняки. Это значительно уменьшает расход химикатов.
*   Улучшение экологической обстановки: сокращение использования гербицидов минимизирует их попадание в почву и воду, что способствует устойчивому развитию сельского хозяйства.
*   Автоматизация труда: решение позволяет сократить затраты на ручной труд для прополки, что особенно актуально в условиях нехватки рабочей силы.

### 2. Целевые метрики для продакшена

**Качество модели на тестовой выборке** 
*   Основная метрика: `Accuracy ≥ 0.92`
    Эта метрика хорошо подходит для многоклассовой классификации с возможным дисбалансом, так как учитывает общее количество истинно-положительных, ложно-отрицательных и ложно-положительных срабатываний по всем классам.
*   Вспомогательные метрики:
    *   `Macro F1-Score ≥ 0.9`

**Надежность и производительность сервиса**
*   Среднее время инференса сервиса: `≤ 1 с`
*   Доля неуспешных запросов: `≤ 5 %`

## Набор данных
Источник: [Plant Seedlings Classification Dataset на Kaggle](https://www.kaggle.com/c/plant-seedlings-classification)
*   Набор содержит изображения ростков 12 видов растений (как культурных, так и сорняков).
*   Количество изображений: ~ 960 уникальных растений на различных стадиях роста.
*   Классы: 12 видов (напр., "Чёрный паслен" (сорняк), "Огурец", "Пшеница" и т.д.).
*   Основная задача: Многоклассовая классификация.
*   Метрика оценки: Accuracy, Macro F1-Score.

## План экспериментов

1.  Предобработка данных: приведение к фиксированному размеру, нормализация пикселей.
      
2.  Аугментация данных для увеличения разнообразия данных и борьбы с переобучением: случайные повороты, отражения, изменение яркости/контрастности, небольшие искажения.

3.  Обучение ResNet50 с добавлением полносвязного слоя.

7.  Тестирование
    *   Написание скрипта для инференса и проверка метрик на тестовой выборке.
    *   Конвертация лучшей модели в формат для продакшена.
    
9.  Подготовка к продакшену

## Запуск кода

* Клонировать репрезиторий:
  
`git clone https://github.com/Srgbhwwvb/mlops.git`

`cd mlops`

* Установка зависимостей:
  
  `pip install -r requirements.txt`

* Для перехода в режим разработчика:
  
  `pip install -e`

* Подготовка данных:
  Скачайте датасет с Kaggle: [https://www.kaggle.com/c/plant-seedlings-classification/data]
  Распакуйте данные в удобное место, например:
  `C:/Users/YourName/Downloads/plant-seedlings-classification/`

  Обновите пути в файле configs/train_config.yaml:
  data:
  
    `train_path: "ВАШ_ПУТЬ/plant-seedlings-classification/train/*/*.png"`
  
    `test_path: "ВАШ_ПУТЬ/plant-seedlings-classification/test/*.png"`
  
* Для запуска обучения:
  
  `python scripts/train.py --config configs/train_config.yaml`
  
* Для запуска обучения с логированием:
  
  `python scripts/train.py --config configs/train_config.yaml --verbose`

* Для загрузки весов лучшей обученной модели и запуска валидации:
  
  `python scripts/validate.py --config configs/train_config.yaml --model_path models/best_model`

* Для запуска тестов:

  `pytest tests/ -v`
  
* Для вывода покрытия:
  
  `python check_coverage.py`

## Результаты на тестовой выборке:
* Accuracy: 0.9663
* Macro F1-Score: 0.9634


