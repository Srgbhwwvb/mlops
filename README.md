# Plant Seedlings Classification

## Цель проекта
Разработка и развертывание модели глубокого обучения для многоклассовой классификации ростков растений с целью автоматического распознавания сорняков. Это позволит создать основу для систем точечной обработки полей. Что приведет:
*   Повышение урожайности: сорняки конкурируют с культурными растениями за воду, свет и питательные вещества. Их своевременное удаление напрямую увеличивает урожайность культурных растений.
*   Снижение затрат на гербициды: вместо обработки всего поля, автономные системы (роботы, дроны) с использованием нашей модели смогут точечно наносить гербициды только на сорняки. Это значительно уменьшает расход химикатов.
*   Улучшение экологической обстановки: сокращение использования гербицидов минимизирует их попадание в почву и воду, что способствует устойчивому развитию сельского хозяйства.
*   Автоматизация труда: решение позволяет сократить затраты на ручной труд для прополки, что особенно актуально в условиях нехватки рабочей силы.

### 2. Целевые метрики для продакшена

Метрики делятся на две группы: качество модели и надежность/производительность сервиса.

**Качество модели (на отложенной тестовой выборке)** 
*   Основная метрика: `Micro-averaged F1-Score ≥ 0.93`
    Эта метрика хорошо подходит для многоклассовой классификации с возможным дисбалансом, так как учитывает общее количество истинно-положительных, ложно-отрицательных и ложно-положительных срабатываний по всем классам.
*   Вспомогательные метрики:
    *   `Accuracy ≥ 0.95`

**Надежность и производительность сервиса**
Эти метрики зависят от инфраструктуры, но вот реалистичные цели:

*   Среднее время инференса (отклика) сервиса: `≤ 1 с`
*   Доля неуспешных запросов (Availability): `≤ 0.5 %`
*   Пропускная способность: `≥ 5 изображений в секунду`
*   Использование ресурсов:
    *   Использование CPU: `< 90%` в пиковой нагрузке

## Набор данных
Источник: [Plant Seedlings Classification Dataset на Kaggle](https://www.kaggle.com/c/plant-seedlings-classification)
*   Набор содержит изображения ростков 12 видов растений (как культурных, так и сорняков).
*   Количество изображений: ~ 960 уникальных растений на различных стадиях роста.
*   Классы: 12 видов (напр., "Чёрный паслен" (сорняк), "Огурец", "Пшеница" и т.д.).
*   Основная задача: Многоклассовая классификация.
*   Метрика оценки: Micro-averaged F1-Score.

## План экспериментов

1.  **Предобработка данных (EDA & Preprocessing)**
    *   Анализ распределения по классам (выявление дисбаланса).
    *   Визуализация примеров изображений.
    *   Проверка на наличие corrupted-файлов.
    *   Преобразование: изменение размера (например, 224x224 для ResNet), нормализация пикселей.
    *   Разделение на тренировочную, валидационную и тестовую выборки (80/10/10).

2.  **Аугментация данных (Data Augmentation)**
    *   Применение аугментаций для увеличения разнообразия данных и борьбы с переобучением: случайные повороты, отражения, изменение яркости/контрастности, небольшие искажения.

3.  **Базовое решение (Baseline)**
    *   Обучение простой CNN-модели для установки базового уровня качества.

4.  **Transfer Learning с предобученными моделями**
    *   Использование предобученных на ImageNet моделей (ResNet50, EfficientNet-B3, VGG16).
    *   Замена и дообучение последних полносвязных слоев.
    *   Сравнение их производительности между собой.

5.  **Тонкая настройка (Fine-Tuning)**
    *   Разморозка и дообучение последних сверточных блоков выбранной модели-лидера для адаптации к специфике домена.

6.  **Оптимизация и анализ модели**
    *   Анализ матрицы ошибок (Confusion Matrix) для выявления проблемных классов.
    *   Применение техник для борьбы с дисбалансом (например, взвешенная функция потерь, oversampling).
    *   Калибровка порогов классификации для критически важных классов (сорняков).

7.  **Экспорт и тестирование**
    *   Конвертация лучшей модели в формат для продакшена.
    *   Написание скрипта для инференса и проверка метрик на тестовой выборке.

8.  **Подготовка к продакшену (MLOps)**
    *   It would be later.

## Запуск кода

* Клонировать репрезиторий:
git clone https://github.com/Srgbhwwvb/mlops.git
cd mlops

* Установка зависимостей:
  pip install -r requirements.txt

* Для запуска обучения:
  python scripts/train.py --config configs/train_config.yaml --verbose
